import{i as m,a as y,r as U,S as z,N as W,P as J,A as ne}from"./assets/vendor-BDtnXfrh.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(a){if(a.ep)return;a.ep=!0;const n=r(a);fetch(a.href,n)}})();const o={feedbackList:document.querySelector(".feedback-list"),categoriesList:document.querySelector(".furniture-categories"),furnitureGrid:document.querySelector(".furniture-gallery"),furnitureLoadMoreBtn:document.querySelector("#furniture-loadMoreBtn"),modalDetailisProduct:document.querySelector(".modal"),popularGoodsList:document.querySelector(".popular-goods-list"),modalOrderForm:document.querySelector(".modal-form"),modalOrderBackground:document.querySelector(".order-modal"),modalOrderEmail:document.querySelector(".input-email"),modalOrderComment:document.querySelector(".textarea"),modalOrderPhone:document.querySelector(".input-phone"),headerOpenModalBtn:document.querySelector("[data-modal-open]"),headerCloseModalBtns:document.querySelectorAll("[data-modal-close]"),headerModal:document.querySelector("[data-modal-mobnav]"),headerMenuLinks:document.querySelectorAll("[data-modal-mobnav] a"),headerBody:document.body,headerScrollButtons:document.querySelectorAll(".scroll-to-furniture"),headerScrollBtns:document.querySelectorAll(".scroll-to-furniture")};(function(){var a,n,c,d;(a=o.headerOpenModalBtn)==null||a.addEventListener("click",e),(n=o.headerCloseModalBtns)==null||n.forEach(l=>l.addEventListener("click",t)),(c=o.headerModal)==null||c.addEventListener("click",r),(d=o.headerMenuLinks)==null||d.forEach(l=>l.addEventListener("click",t)),window.addEventListener("keydown",s);function e(){var l,g;(l=o.headerModal)==null||l.classList.add("isopen"),(g=o.headerBody)==null||g.classList.add("modal-open")}function t(){var l,g;(l=o.headerModal)==null||l.classList.remove("isopen"),(g=o.headerBody)==null||g.classList.remove("modal-open")}function r(l){l.target.closest(".mob-modal-wrap")||t()}function s(l){(l.key==="Escape"||l.code==="Escape")&&t()}})();var V;(V=o.headerScrollBtns)==null||V.forEach(e=>{e.addEventListener("click",t=>{var s,a;t.preventDefault();const r=document.getElementById("furniture");r&&((s=o.headerModal)!=null&&s.classList.contains("isopen")?(o.headerModal.classList.remove("isopen"),(a=o.headerBody)==null||a.classList.remove("modal-open"),setTimeout(()=>{r.scrollIntoView({behavior:"smooth"})},300)):r.scrollIntoView({behavior:"smooth"}))})});window.addEventListener("unhandledrejection",e=>{e.preventDefault()});o.modalOrderForm.addEventListener("submit",ie);async function ie(e){e.preventDefault();const t=localStorage.getItem("orderData");if(!t){m.error({title:"Помилка",message:"Немає інформації про товар. Оформлення неможливе.",position:"topCenter"});return}const r=JSON.parse(t),s=r.productId,a=r.color;if(!s||!a){m.error({title:"Помилка",message:"Немає даних про товар. Спробуйте додати його ще раз.",position:"topCenter"});return}const n=e.currentTarget.elements.email.value.trim(),c=e.currentTarget.elements.phone.value.replace(/^\+/,""),d=e.currentTarget.elements.comment.value.trim(),l={email:n,phone:c,modelId:s,color:a,comment:d},g=o.modalOrderEmail.parentElement.querySelector(".error-text");!n||n.length>64?(o.modalOrderEmail.classList.add("error-message"),E(o.modalOrderEmail,"Не валідний Email")):(o.modalOrderEmail.classList.remove("error-message"),g&&g.remove());const F=o.modalOrderPhone.parentElement.querySelector(".error-text");c?(o.modalOrderPhone.classList.remove("error-message"),F&&F.remove()):(o.modalOrderPhone.classList.add("error-message"),E(o.modalOrderPhone,"Введіть номер телефону"));const I=o.modalOrderComment.parentElement.querySelector(".error-text");d.length<5||d.length>256?(o.modalOrderComment.classList.add("error-message"),E(o.modalOrderComment,"Введіть коментар довжиною від 5 до 256 символів")):(o.modalOrderComment.classList.remove("error-message"),I&&I.remove());const oe=n&&n.length<=64&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n),se=/^380\d{9}$/.test(c),ae=d.length>=5&&d.length<=256;if(!oe||!se||!ae){m.error({title:"Помилка",message:"Будь ласка, виправ помилки у формі",position:"topCenter"});return}await ue(l)?(m.success({title:"Успіх",message:"Форма успішно відправлена!",position:"topCenter"}),o.modalOrderForm.reset(),L()):m.error({title:"Помилка",message:"Будь ласка, виправ помилки у формі",position:"topCenter"})}function E(e,t){if(!e.parentElement.querySelector(".error-text")){const s=`<p class="error-text">${t}</p>`;e.insertAdjacentHTML("afterend",s)}}function ce(){document.body.classList.add("body--no-scroll"),o.modalOrderBackground.classList.add("order-open")}function L(){document.body.classList.remove("body--no-scroll"),o.modalOrderBackground.classList.remove("order-open"),localStorage.clear()}function de(){document.querySelector(".close-form-btn").addEventListener("click",L),document.addEventListener("keydown",t=>{t.key==="Escape"&&L()}),o.modalOrderBackground.addEventListener("click",t=>{t.target===o.modalOrderBackground&&L()})}de();function O(e){e.addEventListener("focus",()=>{e.removeAttribute("placeholder"),e===o.modalOrderPhone&&(e.value.startsWith("+380")||(e.value="+380"))}),e===o.modalOrderPhone&&e.addEventListener("input",()=>{o.modalOrderPhone.value="+380"+o.modalOrderPhone.value.replace(/\D/g,"").slice(3)})}O(o.modalOrderEmail);O(o.modalOrderComment);O(o.modalOrderPhone);function C(e,t){e.addEventListener("blur",()=>{e.setAttribute("placeholder",`${t}`)})}C(o.modalOrderEmail,"12345ggg@gmail.com");C(o.modalOrderComment,"Type your message...");C(o.modalOrderPhone,"+38 (099) 123 22 11");const le="https://furniture-store.b.goit.study/api";async function ue(e){var t,r;try{return(await y.post(`${le}/orders`,e,{headers:{"Content-Type":"application/json"}})).status===201}catch(s){const a=((r=(t=s.response)==null?void 0:t.data)==null?void 0:r.message)||"Помилка запиту";return m.error({title:"Помилка",message:a,position:"topCenter"}),!1}}const T=document.querySelector(".modal-content"),me=document.querySelector(".star-to-run"),pe=me.getAttribute("src");function K(e){he();const t=e.map(fe).join("");T.innerHTML=t,be(e[0]),T.querySelectorAll(".star-value").forEach(d=>{d.style.backgroundImage=`url("${pe}")`});const r=document.getElementById("main-product-img"),s=document.querySelectorAll(".mini-img"),a=r.src,n=r.alt;s.forEach(d=>{d.addEventListener("mouseover",()=>{r.style.opacity=.5,setTimeout(()=>{r.src=d.src,r.alt=d.alt,r.style.opacity=1},200)}),d.addEventListener("mouseout",()=>{r.style.opacity=.5,setTimeout(()=>{r.src=a,r.alt=n,r.style.opacity=1},200)})}),ve(),document.querySelector(".detailis-product").addEventListener("submit",ye)}function fe({_id:e,images:t,name:r,price:s,rate:a,sizes:n,color:c,description:d,type:l}){return`
    <div class="img-product">
      <img class="large-img" src="${t[0]}" alt="${r}" id="main-product-img"/>
      <div class="small-img">
        <img class="mini-img" src="${t[1]}" alt="${r}" />
        <img class="mini-img" src="${t[2]}" alt="${r}" />
      </div>
    </div>

    <div class="product-wrapper">
      <div class="product-content">
        <h2 class="title-modal-product">${r}</h2>
        <p class="type-product-modal">${l}</p>
        <p class="price">${s} <span class="hrn"></span>грн</p>
        <div id="rater-modal-${e}" data-rating-modal="${a}"  aria-label="Rated ${a} out of 5 stars"></div>
      </div>

      <form class="detailis-product">
        <p class="select-color" aria-label="Choose product color">Колір</p>
        <div class="radio-group">
          ${ge(c)}
        </div>

        <div class="discription-container">
          <p class="description">${d}</p>
          <p class="size">Розміри:  <span class="size-span">${n}</span></p>
        </div>

        <div class="modal-product-actions">
          <button class="modal-product-btn" type="submit" data-id=${e} aria-label="Open order form modal">
            Перейти до замовлення
          </button>
        </div>
      </form>
    </div>
  `}function ge(e){return e.map((t,r)=>`
    <label class="color-label">
      <input type="radio" name="color" value="${t}" ${r===0?"checked":""} />
      <span class="circle" style="background-color: ${t}"></span>
      <span class="checkmark"></span>
    </label>
  `).join("")}function be({rate:e,_id:t}){U({max:5,readOnly:!0,rating:e,starSize:20,element:document.querySelector(`#rater-modal-${t}`)})}function ye(e){var n;e.preventDefault();const r=document.querySelector(".modal-product-btn").dataset.id,s=(n=e.target.querySelector('input[name="color"]:checked'))==null?void 0:n.value;if(!s){m.warning({title:"Увага",message:"Оберіть колір перед замовленням",position:"topRight"});return}const a={productId:r,color:s};localStorage.setItem("orderData",JSON.stringify(a)),S(),ce()}function he(){document.body.classList.add("body--no-scroll"),o.modalDetailisProduct.classList.add("modal--is-open")}function S(){document.body.classList.remove("body--no-scroll"),o.modalDetailisProduct.classList.remove("modal--is-open")}function ve(){document.querySelector(".modal-close-btn").addEventListener("click",S),document.addEventListener("keydown",t=>{t.key==="Escape"&&S()}),o.modalDetailisProduct.addEventListener("click",t=>{t.target===o.modalDetailisProduct&&S()})}const p={allProductsImg:document.querySelector(".all-products"),bathroomFurniture:document.querySelector(".bathroom-furniture"),bedsAndMattresses:document.querySelector(".beds-and-mattresses"),cabinets:document.querySelector(".cabinets-and-storage-systems"),chairsAndStools:document.querySelector(".chairs-and-stools"),childrensFurniture:document.querySelector(".childrens-furniture"),decorAndAccessories:document.querySelector(".decor-and-accessories"),gardenAndOutdoor:document.querySelector(".garden-and-outdoor-furnitur"),hallwayFurniture:document.querySelector(".hallway-furniture"),kitchens:document.querySelector(".kitchens"),officeFurniture:document.querySelector(".office-furniture"),tables:document.querySelector(".tables"),upholsteredFurniture:document.querySelector(".upholstered-furniture")};let b=[];const A="https://furniture-store.b.goit.study/api/";o.categoriesList.addEventListener("click",$e);o.furnitureLoadMoreBtn.addEventListener("click",Q);Se();let k=window.innerWidth>=768;setTimeout(()=>{k?v(f,1):B(f,1)},100);let x;window.addEventListener("resize",()=>{clearTimeout(x),x=setTimeout(()=>{const e=window.innerWidth>=768;if(e!==k){k=e;const t=o.categoriesList.querySelector(".category-btn.active"),r=t?t.dataset.category:"";i=1,o.furnitureGrid.innerHTML="",e?($(),v(f,i,r)):B(f,i,r)}},250)});let D=!0;function Le(){Y(b),Pe(),setTimeout(()=>{D||Ce(),D=!1},300)}async function Se(){try{const t=(await y.get(`${A}categories`)).data;ke(t)}catch{m.error({title:"Помилка",message:"Не вдалося завантажити дані. Спробуйте пізніше",position:"topRight"})}finally{}}function ke(e){const t={"":`${p.allProductsImg.src}`,"66504a50a1b2c3d4e5f6a7b8":`${p.upholsteredFurniture.src}`,"66504a50a1b2c3d4e5f6a7b9":`${p.cabinets.src}`,"66504a50a1b2c3d4e5f6a7ba":`${p.bedsAndMattresses.src}`,"66504a50a1b2c3d4e5f6a7bb":`${p.tables.src}`,"66504a50a1b2c3d4e5f6a7bc":`${p.chairsAndStools.src}`,"66504a50a1b2c3d4e5f6a7bd":`${p.kitchens.src}`,"66504a50a1b2c3d4e5f6a7be":`${p.childrensFurniture.src}`,"66504a50a1b2c3d4e5f6a7bf":`${p.officeFurniture.src}`,"66504a50a1b2c3d4e5f6a7c0":`${p.hallwayFurniture.src}`,"66504a50a1b2c3d4e5f6a7c1":`${p.bathroomFurniture.src}`,"66504a50a1b2c3d4e5f6a7c2":`${p.gardenAndOutdoor.src}`,"66504a50a1b2c3d4e5f6a7c3":`${p.decorAndAccessories.src}`},r=[{_id:"",name:"Всі товари"},...e].map(({_id:s,name:a})=>{const n=t[s];return`
        <li>
        <button type="button"
         class="category-btn${s===""?" active":""}"
          data-category="${s}"  style="${n?`background-image: url('${n}');background-size: cover; background-position: center;"`:""}">
          ${a}
          </button>
          </li>
          `}).join("");o.categoriesList.insertAdjacentHTML("beforeend",r)}let i=1;const f=8;let u=1;async function B(e,t,r=""){try{const s={limit:e,page:t};r&&(s.category=r);const n=(await y.get(`${A}furnitures`,{params:s})).data;b=n.furnitures,u=Math.ceil(n.totalItems/Number(e));const c=n.furnitures;t===1?(o.furnitureGrid.innerHTML="",b=c):b=[...b,...c],u=Math.ceil(n.totalItems/e),Y(c),j(),t>=u?$():j()}catch{m.error({title:"Помилка",message:"Не вдалося завантажити дані. Спробуйте пізніше",position:"topRight"}),$()}}function Y(e){const t=e.map(({_id:r,name:s,images:a,color:n,price:c})=>{const d=` <ul class="color-list"> 
        ${n.map(l=>`<li class="color-dot" style="background-color:${l}"></li>`).join("")}
        </ul> `;return`
        <li class="furniture-card">
        <img src="${a[0]}" alt="${s}" class="furniture-img">
        <h3 class="furniture-name">${s}</h3>
         ${d}
        <p class="furniture-price">${c} грн</p>
        <button class="furniture-btn btn-details" data-id="${r}">Детальніше</button>
        </li>
        `}).join("");o.furnitureGrid.insertAdjacentHTML("beforeend",t)}function $e(e){if(!e.target.classList.contains("category-btn"))return;o.categoriesList.querySelectorAll(".category-btn").forEach(s=>s.classList.remove("active")),e.target.classList.add("active");const r=e.target.dataset.category;i=1,k?v(f,i,r):B(f,i,r)}function j(){o.furnitureLoadMoreBtn.classList.remove("visually-hidden-moreBtn")}function $(){o.furnitureLoadMoreBtn.classList.add("visually-hidden-moreBtn")}o.furnitureLoadMoreBtn.addEventListener("click",Q);const N=document.querySelector("#furniture-prevBtn"),R=document.querySelector("#furniture-nextBtn"),G=document.querySelector("#furniture-paginationNumbers");N&&N.addEventListener("click",we);R&&R.addEventListener("click",Be);G&&G.addEventListener("click",Ee);function Q(e){i+=1;const t=o.categoriesList.querySelector(".category-btn.active"),r=t?t.dataset.category:"";B(f,i,r)}function we(){if(i>1){i-=1;const e=o.categoriesList.querySelector(".category-btn.active"),t=e?e.dataset.category:"";v(f,i,t)}}function Be(){if(i<u){i+=1;const e=o.categoriesList.querySelector(".category-btn.active"),t=e?e.dataset.category:"";v(f,i,t)}}function Ee(e){if(e.target.classList.contains("page-number")){const t=parseInt(e.target.dataset.page);if(t!==i){i=t,localStorage.setItem("currentPage",i);const r=o.categoriesList.querySelector(".category-btn.active"),s=r?r.dataset.category:"";v(f,i,s)}}}async function v(e,t,r=""){try{const s={limit:e,page:t};r&&(s.category=r),Me();//! тут зявляється лоадер
const n=(await y.get(`${A}furnitures`,{params:s})).data;b=n.furnitures,u=Math.ceil(n.totalItems/e),o.furnitureGrid.innerHTML="",$(),Le();//! тут виклик нової ф. яка рендерить продукти+ обновляє сторінки+котроль скролу
}catch{m.error({title:"Помилка",message:"Не вдалося завантажити дані. Спробуйте пізніше",position:"topRight"})}finally{Oe();//!тут ховаю лоадер
}}o.furnitureGrid.addEventListener("click",e=>{const t=e.target.closest(".furniture-btn");if(!t)return;const r=t.dataset.id,s=b.find(a=>a._id===r);s?K([s]):m.error({title:"Помилка",message:"Не вдалося завантажити дані. Спробуйте пізніше",position:"topRight"})});function Pe(){const e=document.querySelector("#furniture-prevBtn"),t=document.querySelector("#furniture-nextBtn");e&&(e.disabled=i<=1),t&&(t.disabled=i>=u),qe()}function qe(){const e=document.querySelector("#furniture-paginationNumbers");if(!e)return;let t="";if(u<=7)for(let r=1;r<=u;r++)t+=`<button class="page-number ${r===i?"active":""}" data-page="${r}">${r}</button>`;else if(t+=`<button class="page-number ${i===1?"active":""}" data-page="1">1</button>`,i<=3){for(let r=2;r<=3;r++)t+=`<button class="page-number ${r===i?"active":""}" data-page="${r}">${r}</button>`;t+='<span class="page-dots">...</span>',t+=`<button class="page-number" data-page="${u}">${u}</button>`}else if(i>=u-3){t+='<span class="page-dots">...</span>';for(let r=u-3;r<=u;r++)t+=`<button class="page-number ${r===i?"active":""}" data-page="${r}">${r}</button>`}else{t+='<span class="page-dots">...</span>';for(let r=i-1;r<=i+1;r++)t+=`<button class="page-number ${r===i?"active":""}" data-page="${r}">${r}</button>`;t+='<span class="page-dots">...</span>',t+=`<button class="page-number" data-page="${u}">${u}</button>`}e.innerHTML=t}function Me(){document.getElementById("loader").classList.remove("hidden")}function Oe(){document.getElementById("loader").classList.add("hidden")}function Ce(){const e=document.querySelector(".furniture-gallery");if(!e)return;const r=e.getBoundingClientRect().top+window.scrollY-140;window.scrollTo({top:r,behavior:"smooth"})}function Ae(){document.querySelector(".popular-goods-swiper").remove()}async function Fe(){try{return(await y.get("https://furniture-store.b.goit.study/api/furnitures?type=popular")).data.furnitures||[]}catch(e){Ae(),m.error({title:e.message,position:"topRight"})}}async function Ie(){const e=await Fe();if(!e||e.length<3){m.info({title:"Увага",message:"Недостатньо товарів для відображення (мінімум 3)",position:"topRight"});return}const t=e.map(({images:r,name:s,color:a,price:n,_id:c})=>(s.length>28&&(s=s.slice(0,28)+"..."),`
      <li class="popular-goods-item swiper-slide">
        <img class="popular-goods-img" src="${r[0]}" alt="${s}">
        <div class="popular-goods-item-desc">
            <h3 class="popular-goods-item-title">${s}</h3>
            <ul class="popular-goods-colors">
                ${a.map(d=>`<input type="checkbox" class="goods-color" style="background-color: ${d}" disabled>`).join("")}
            </ul>
            <p class="popular-goods-price">${n} грн</p>
        </div>
        <button class="furniture-btn btn-details" data-id="${c}">Детальніше</button>
      </li>
        `)).join("");o.popularGoodsList.innerHTML=t,new z(".popular-goods-swiper",{modules:[W,J],pagination:{el:".popular-goods-swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{nextEl:".popular-goods-swiper-button-next",prevEl:".popular-goods-swiper-button-prev"},grabCursor:!0,breakpoints:{375:{slidesPerView:1,spaceBetween:16},768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:4,spaceBetween:24}}}),o.popularGoodsList.addEventListener("click",r=>{const s=r.target.closest(".furniture-btn");if(!s)return;const a=s.dataset.id,n=e.find(c=>c._id===a);K([n])})}Ie();document.addEventListener("DOMContentLoaded",()=>{new ne(".accordion-container",{duration:1e3,showMultiple:!1,collapse:!0})});y.defaults.baseURL="https://furniture-store.b.goit.study/api";const Te=document.querySelector(".star-to-run"),X=Te.getAttribute("src"),Z=document.querySelector(".feedback");function _(){document.querySelector(".feedback-swiper").remove()}let h=1,w=1,P=!1,q=null,M=[];async function ee(e=1){try{const t=await y.get(`/feedbacks?limit=3&page=${e}`);return{feedbacks:t.data.feedbacks||[],totalPages:Math.ceil(t.data.total/t.data.limit)||1,currentPage:parseInt(t.data.page)||1}}catch{return _(),m.error({title:"Помилка",message:"Не вдалось завантажити дані. Спробуйте пізніше",position:"topRight"}),null}}function te({descr:e,name:t,rate:r,_id:s}){return`
    <li class="feedback-item swiper-slide">
        <div id="rater-${s}" data-rating="${r}"></div>
        <p class="feedback-descr">${e}</p>
        <p class="feedback-name">${t}</p>
    </li>`}async function H(){if(P||h>=w)return;P=!0;const e=h+1,t=await ee(e);if(t&&t.feedbacks.length>0){h=t.currentPage,M=[...M,...t.feedbacks];const r=t.feedbacks.map(s=>te(s)).join("");o.feedbackList.insertAdjacentHTML("beforeend",r),re(t.feedbacks),Z.querySelectorAll(".star-value").forEach(s=>{s.style.backgroundImage=`url("${X}")`}),q&&q.update()}P=!1}async function xe(){const e=await ee(1);if(!e||e.feedbacks.length<3){_(),m.info({title:"Увага",message:"Недостатньо відгуків для відображення (мінімум 3)",position:"topRight"});return}M=e.feedbacks,h=e.currentPage,w=e.totalPages;const t=e.feedbacks.map(r=>te(r)).join("");o.feedbackList.insertAdjacentHTML("beforeend",t),re(e.feedbacks),Z.querySelectorAll(".star-value").forEach(r=>{r.style.backgroundImage=`url("${X}")`}),De()}function re(e){e.forEach(({rate:t,_id:r})=>{U({max:5,readOnly:!0,rating:t,starSize:20,element:document.querySelector(`#rater-${r}`)})})}function De(){q=new z(".feedback-swiper",{modules:[W,J],pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},grabCursor:!0,breakpoints:{375:{slidesPerView:1,spaceBetween:20},768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3,spaceBetween:24}},on:{reachEnd:function(){h<w&&H()},slideChange:function(){this.slides.length-this.activeIndex-this.slidesPerViewDynamic()<=2&&h<w&&H()}}})}xe();
//# sourceMappingURL=index.js.map
